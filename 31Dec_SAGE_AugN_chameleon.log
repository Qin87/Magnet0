Namespace(withAug=False, AugDirect=20, method_name='SAGE', GPUdevice=1, IsDirectedData=True, dataset='WikipediaNetwork/chameleon', undirect_dataset='Amazon-Computers', MakeImbalance=True, CustomizeMask=False, seed=100, K=2, heads=8, log_root='../logs/', log_path='test', data_path='../dataset/data/tmp/', epochs=1500, num_filter=2, p_q=0.95, p_inter=0.1, dropout=0.0, debug=False, new_setting=False, layer=2, lr=0.005, l2=0.0005, to_undirected=False, alpha=0.1, randomseed=-1, imb_ratio=100, n_layer=2, feat_dim=64, warmup=5, epoch=900, tau=2, max=False, no_mask=False, gdc='ppr')
CUDA Device Index: 1
12-31-14:25:43
excel_file_path is  FalseAug_SAGE_WikipediaNetworkchameleon12-31-14:25:43_dir.xlsx
dataset is  WikipediaNetwork chameleon
Dataset is  WikipediaNetwork() 
Chosen from DirectedData:  True
Num of bidrected edges: 4680, total num of edges: 36101
This is directed graph:  True
data_x torch.Size([2277, 2325])
splits 10
GraphSAGE2(
  (conv1): SAGEConv(2325, 64)
  (conv2): SAGEConv(64, 5)
)
Beginning for split:  0 31-14:26:01
Early stop at epoch:  511
split:   0, val_loss:  10.60, test_Acc:  28.51, test_bacc:  27.20, test_f1:  20.68
Beginning for split:  1 31-14:27:55
Early stop at epoch:  510
split:   1, val_loss:   9.95, test_Acc:  29.61, test_bacc:  28.02, test_f1:  21.96
Beginning for split:  2 31-14:30:59
Early stop at epoch:  512
split:   2, val_loss:   7.40, test_Acc:  37.28, test_bacc:  34.58, test_f1:  28.79
Beginning for split:  3 31-14:35:04
Early stop at epoch:  513
split:   3, val_loss:   8.05, test_Acc:  39.91, test_bacc:  38.06, test_f1:  31.47
Beginning for split:  4 31-14:42:00
Early stop at epoch:  515
split:   4, val_loss:   9.12, test_Acc:  36.84, test_bacc:  35.94, test_f1:  28.53
Beginning for split:  5 31-14:51:51
Early stop at epoch:  524
split:   5, val_loss:   7.43, test_Acc:  38.60, test_bacc:  33.26, test_f1:  28.28
Beginning for split:  6 31-15:03:46
Early stop at epoch:  502
split:   6, val_loss:   7.56, test_Acc:  29.82, test_bacc:  28.94, test_f1:  22.71
Beginning for split:  7 31-15:16:41
Traceback (most recent call last):
  File "/home/qj2004/magnet/src/GNNChangeTrainTest.py", line 648, in <module>
    main(args)
  File "/home/qj2004/magnet/src/GNNChangeTrainTest.py", line 440, in main
    out = model(data_x, edges)
  File "/home/qj2004/.conda/envs/myenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1130, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/qj2004/magnet/src/nets_graphSHA/sage.py", line 129, in forward
    x = F.relu(self.conv1(x, edge_index, edge_weight))
  File "/home/qj2004/.conda/envs/myenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1130, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/qj2004/magnet/src/nets_graphSHA/sage.py", line 78, in forward
    out = self.propagate(edge_index, x=x, size=size)
  File "/home/qj2004/.conda/envs/myenv/lib/python3.10/site-packages/torch_geometric/nn/conv/message_passing.py", line 455, in propagate
    coll_dict = self._collect(self._user_args, edge_index, size,
  File "/home/qj2004/.conda/envs/myenv/lib/python3.10/site-packages/torch_geometric/nn/conv/message_passing.py", line 329, in _collect
    data = self._lift(data, edge_index, dim)
  File "/home/qj2004/.conda/envs/myenv/lib/python3.10/site-packages/torch_geometric/nn/conv/message_passing.py", line 276, in _lift
    raise e
  File "/home/qj2004/.conda/envs/myenv/lib/python3.10/site-packages/torch_geometric/nn/conv/message_passing.py", line 266, in _lift
    return src.index_select(self.node_dim, index)
RuntimeError: CUDA out of memory. Tried to allocate 322.00 MiB (GPU 1; 23.69 GiB total capacity; 66.01 MiB already allocated; 321.12 MiB free; 76.00 MiB reserved in total by PyTorch) If reserved memory is >> allocated memory try setting max_split_size_mb to avoid fragmentation.  See documentation for Memory Management and PYTORCH_CUDA_ALLOC_CONF
